$(function(){"use strict";$(".table-dynamic-location").DataTable({processing:!0,ajax:"../../../../data/location.json",responsive:!0,scrollX:!0,language:{searchPlaceholder:"Search...",sSearch:""},columns:[{data:"id"},{data:"name"},{data:"num_notify"},{data:"point"},{data:null}],columnDefs:[{targets:[0,2],class:"text-center"},{orderable:!1,targets:[-1],class:"text-center",render:function(e,o,t,n){return' <span class="btn-action table-action-edit cursor-pointer tx-success" data-id="'+e.id+'"><i class="fa fa-edit"></i></span> <span class="btn-action table-action-delete cursor-pointer tx-danger" data-id="'+e.id+'"><i class="fa fa-trash"></i></span>'}}]});$(".dataTables_length select").select2({minimumResultsForSearch:1/0}),$(document).on("click",".table-dynamic-location .table-action-delete",function(e){e.preventDefault();var o=$(this).attr("data-id");$("#confirm-delete-modal #id").val(o),$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1})}),$("#confirm-delete-modal").on("click","#confirm-delete",function(e){$("#confirm-delete-modal #id").val()}),$(document).on("click","#addLocation",function(e){e.preventDefault(),$("#modal-location #ttlModal").html("Add location"),$("#modal-location").modal("show")}),$(document).on("click","#btnLocation",function(e){e.preventDefault(),$("#LocForm").submit()}),$("#LocationForm").on("submit",function(e){e.preventDefault();var o=$(this);o.parsley().validate(),o.parsley().isValid()&&alert("valid")});var r,t,l=!0,i=[],s=["#1E90FF"],c={};function d(){t&&(t.setEditable(!1),t=null)}function g(e){d(),(t=e).setEditable(!1),u(e.get("fillColor")||e.get("strokeColor"))}function p(){l&&r.setDrawingMode(google.maps.drawing.OverlayType.POLYGON)}function m(){for(var e=0;e<i.length;e++)i[e].overlay.setMap(null);i=[],l=!0}function u(e){e;for(var o=0;o<s.length;++o){var t=s[o];c[t].style.border=t==e?"2px solid #789":"2px solid #fff"}var n=r.get("polylineOptions");n.strokeColor=e,r.set("polylineOptions",n);var a=r.get("rectangleOptions");a.fillColor=e,r.set("rectangleOptions",a);var l=r.get("circleOptions");l.fillColor=e,r.set("circleOptions",l);var i=r.get("polygonOptions");i.fillColor=e,r.set("polygonOptions",i)}function f(o){var e=document.createElement("span");return e.className="color-button",e.style.backgroundColor=o,google.maps.event.addDomListener(e,"click",function(){var e;u(o),e=o,t&&(t.type==google.maps.drawing.OverlayType.POLYLINE?t.set("strokeColor",e):t.set("fillColor",e))}),e}google.maps.event.addDomListener(window,"load",function(){var n=new google.maps.Map(document.getElementById("map"),{zoom:10,center:new google.maps.LatLng(22.344,114.048),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0}),e=document.getElementById("pac-input"),o=new google.maps.places.SearchBox(e);n.addListener("bounds_changed",function(){o.setBounds(n.getBounds())});var a=[];o.addListener("places_changed",function(){var e=o.getPlaces();if(0!=e.length){a.forEach(function(e){e.setMap(null)}),a=[];var t=new google.maps.LatLngBounds;e.forEach(function(e){if(e.geometry){var o={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};a.push(new google.maps.Marker({map:n,icon:o,title:e.name,position:e.geometry.location})),e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)}else console.log("Returned place contains no geometry")}),n.fitBounds(t)}});var t={strokeWeight:0,fillOpacity:.45,editable:!1};r=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.POLYGON,drawingControl:!1,drawingControlOptions:{drawingModes:[google.maps.drawing.OverlayType.POLYGON]},markerOptions:{draggable:!0},polylineOptions:{editable:!1},rectangleOptions:t,circleOptions:t,polygonOptions:t,map:n}),google.maps.event.addListener(r,"overlaycomplete",function(e){e.type==google.maps.drawing.OverlayType.CIRCLE&&e.overlay.getRadius()}),google.maps.event.addListener(r,"overlaycomplete",function(e){if(i.push(e),e.type!=google.maps.drawing.OverlayType.MARKER){r.setDrawingMode(null),r.setOptions({drawingControl:!1});var o=e.overlay;o.type=e.type,google.maps.event.addListener(o,"click",function(){g(o)}),g(o)}}),google.maps.event.addListener(r,"polygoncomplete",function(e){l=!1;for(var o="",t=[],n=0;n<e.getPath().getLength();n++)t.push(e.getPath().getAt(n).toUrlValue(6)),o+=e.getPath().getAt(n).toUrlValue(6)+";";document.getElementById("point").value=o,console.log(t)}),google.maps.event.addListener(r,"drawingmode_changed",d),google.maps.event.addListener(n,"click",d),google.maps.event.addDomListener(document.getElementById("delete-button"),"click",m),google.maps.event.addDomListener(document.getElementById("draw-button"),"click",p),function(){for(var e=document.getElementById("color-palette"),o=0;o<s.length;++o){var t=s[o],n=f(t);e.appendChild(n),c[t]=n}u(s[0])}()})});