var table_dynamic_news,api_fileuploader_icon;$(function(){"use strict";table_dynamic_news=$(".table-dynamic-news").DataTable({processing:!0,ajax:"../../../../data/news.json",responsive:!0,scrollX:!0,language:{searchPlaceholder:"Search...",sSearch:""},dom:"<l<t>i>",columns:[{data:"id"},{data:"name"},{data:null,searchable:!1},{data:null,searchable:!1},{data:null}],columnDefs:[{targets:[0],class:"text-center"},{orderable:!1,targets:[-1],class:"text-center",render:function(e,a,i,n){return' <span class="btn-action table-action-edit cursor-pointer tx-success" data-id="'+e.id+'"><i class="fa fa-edit"></i></span> <span class="btn-action table-action-delete cursor-pointer tx-danger" data-id="'+e.id+'"><i class="fa fa-trash"></i></span>'}},{orderable:!1,targets:[-2],class:"text-center",render:function(e,a,i,n){return'<i class="'+e.icon+' tx-16"></i>'}},{orderable:!1,targets:[-3],class:"text-center",render:function(e,a,i,n){return'<span><a data-id="'+e.id+'" class="upBtn btn-action tx-info"><i class="fa fa-caret-square-o-up"></i></a></span><span class="mg-l-5"><a data-id="'+e.id+'" class="downBtn btn-action tx-info"><i class="fa fa-caret-square-o-down"></i></a></span>'}}],drawCallback:function(){$(".table-dynamic-news tr:nth-child(1) .upBtn").remove(),$(".table-dynamic-news tr:nth-child(1) .downBtn").parent().removeClass("mg-l-5"),$(".table-dynamic-news tr:last .downBtn").remove(),$(".table-dynamic-news tr:last .upBtn").parent().next().removeClass("mg-l-5"),$(".upBtn").unbind("click"),$(".downBtn").unbind("click"),$(".upBtn").on("click",function(){moveUp($(this))}),$(".downBtn").on("click",function(){moveDown($(this))})}}),$(".dataTables_length select").select2({minimumResultsForSearch:1/0}),0<$("textarea").length&&$("textarea").summernote({height:300,tooltip:!1}),$(document).on("click",".table-dynamic-news .table-action-delete",function(e){e.preventDefault();var a=$(this).attr("data-id");$("#confirm-delete-modal #id").val(a),$("#confirm-delete-modal").modal({backdrop:"static",keyboard:!1})}),$("#confirm-delete-modal").on("click","#confirm-delete",function(e){$("#confirm-delete-modal #id").val()}),$(document).on("click","#addNews",function(e){e.preventDefault(),$("#modal-news #ttlModal").html("Add news"),$("#modal-news").modal("show")}),$(document).on("click","#btnNews",function(e){e.preventDefault(),$("#NewsForm").submit()}),$("#NewsForm").on("submit",function(e){e.preventDefault();var a=$(this);a.parsley().validate(),a.parsley().isValid()&&alert("valid")}),void 0!==api_fileuploader_icon&&(api_fileuploader_icon.reset(),api_fileuploader_icon.destroy()),fileuploader("input#icon")});var moveUp=function(e){e.data("id");var a=e.parents("tr");$.ajax({success:function(e){moveRow(a,"up"),table_dynamic_news.ajax.reload(null,!1)},error:function(e,a,i){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},moveDown=function(e){e.data("id");var a=e.parents("tr");$.ajax({success:function(e){moveRow(a,"down"),table_dynamic_news.ajax.reload(null,!1)},error:function(e,a,i){Lobibox.notify("warning",{title:"Thông báo",pauseDelayOnHover:!0,continueDelayOnInactiveTab:!1,icon:!1,sound:!1,msg:response.msg})}})},moveRow=function(e,a){var i=table_dynamic_news.row(e).index(),n=-1;"down"===a&&(n=1);var t=table_dynamic_news.row(i).data();t.sort+=n;var l=table_dynamic_news.row(i+n).data();l.sort+=-n,table_dynamic_news.row(i).data(l),table_dynamic_news.row(i+n).data(t),table_dynamic_news.draw(!1)},fileuploader=function(e){0<$(e).length&&($(e).fileuploader({limit:1,extensions:["jpg","jpeg","png","gif"],changeInput:" ",theme:"thumbnails",enableApi:!0,addMore:!0,thumbnails:{box:'<div class="fileuploader-items"><ul class="fileuploader-items-list"><li class="fileuploader-thumbnails-input"><div class="fileuploader-thumbnails-input-inner"><i>+</i></div></li></ul></div>',item:'<li class="fileuploader-item file-has-popup"><div class="fileuploader-item-inner"><div class="type-holder">${extension}</div><div class="actions-holder"><a class="fileuploader-action fileuploader-action-remove" title="${captions.remove}"><i></i></a></div><div class="thumbnail-holder">${image}<span class="fileuploader-action-popup"></span></div><div class="content-holder"><h5>${name}</h5></div><div class="progress-holder">${progressBar}</div></div></li>',item2:'<li class="fileuploader-item file-has-popup"><div class="fileuploader-item-inner"><div class="type-holder">${extension}</div><div class="actions-holder"><a href="${file}" class="fileuploader-action fileuploader-action-download" title="${captions.download}" download><i></i></a><a class="fileuploader-action fileuploader-action-remove" title="${captions.remove}"><i></i></a></div><div class="thumbnail-holder">${image}<span class="fileuploader-action-popup"></span></div><div class="content-holder"><h5>${name}</h5></div><div class="progress-holder">${progressBar}</div></div></li>',startImageRenderer:!0,canvasImage:!0,_selectors:{list:".fileuploader-items-list",item:".fileuploader-item",start:".fileuploader-action-start",retry:".fileuploader-action-retry",remove:".fileuploader-action-remove"},onImageLoaded:function(e){},onItemShow:function(e,a,i,n,t){var l=a.find(".fileuploader-thumbnails-input"),o=$.fileuploader.getInstance(t.get(0));l.insertAfter(e.html)[(o.getOptions().limit&&o.getAppendedFiles().length||o.getOptions().limit&&o.getChoosedFiles().length)>=o.getOptions().limit?"hide":"show"](),"image"==e.format&&e.html.find(".fileuploader-item-icon").hide()},onItemRemove:function(e,a,i,n,t){var l=a.find(".fileuploader-thumbnails-input"),o=$.fileuploader.getInstance(t.get(0));e.children().animate({opacity:0},200,function(){setTimeout(function(){e.remove(),o.getFiles().length-1<o.getOptions().limit&&l.show()},100)})}},dragDrop:{container:".fileuploader-thumbnails-input"},editor:{cropper:{ratio:"1:1",minWidth:128,minHeight:128,showGrid:!0}},afterRender:function(e,a,i,n){var t=e.find(".fileuploader-thumbnails-input"),l=$.fileuploader.getInstance(n.get(0));t.on("click",function(){l.open()})}}),api_fileuploader_icon=$.fileuploader.getInstance("input#icon"))};